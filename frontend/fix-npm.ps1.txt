Write-Host "üöÄ Reparando entorno de Node y npm..."

# 1Ô∏è‚É£ Detiene cualquier proceso npm o node
Get-Process node -ErrorAction SilentlyContinue | Stop-Process -Force
Get-Process npm -ErrorAction SilentlyContinue | Stop-Process -Force

# 2Ô∏è‚É£ Elimina configuraciones previas de npm
Remove-Item "$env:AppData\npm" -Recurse -Force -ErrorAction SilentlyContinue
Remove-Item "$env:AppData\npm-cache" -Recurse -Force -ErrorAction SilentlyContinue
Remove-Item "$env:UserProfile\.npmrc" -Force -ErrorAction SilentlyContinue

# 3Ô∏è‚É£ Limpia rutas del Python fantasma
setx PATH "$($env:Path -split ';' | Where-Object {$_ -notmatch 'Python37'} -join ';')" /M

# 4Ô∏è‚É£ Reinstala npm global limpio
Write-Host "üì¶ Reinstalando npm global..."
npm install -g npm@latest --force

# 5Ô∏è‚É£ Muestra la versi√≥n final
Write-Host "‚úÖ Versi√≥n final de Node:"
node -v
Write-Host "‚úÖ Versi√≥n final de npm:"
npm -v
Write-Host "‚úÖ Entorno reparado correctamente. Reinicia PowerShell antes de volver a usar npm."

